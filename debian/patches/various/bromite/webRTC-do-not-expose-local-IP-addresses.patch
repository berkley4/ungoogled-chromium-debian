From: csagan5 <32685696+csagan5@users.noreply.github.com>
Date: Sat, 9 May 2020 14:42:37 +0200
Subject: webRTC: do not expose local IP addresses

Prevent leaks of local IP address and public IP address (when using VPN)

See also:
* https://github.com/bromite/bromite/issues/553
* https://github.com/bromite/bromite/issues/589

License: GPL-3.0-only - https://spdx.org/licenses/GPL-3.0-only.html
---
 chrome/browser/ui/browser_ui_prefs.cc                       | 2 +-
 .../peerconnection/peer_connection_dependency_factory.cc    | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)

--- a/third_party/blink/renderer/modules/peerconnection/peer_connection_dependency_factory.cc
+++ b/third_party/blink/renderer/modules/peerconnection/peer_connection_dependency_factory.cc
@@ -111,7 +111,9 @@
     return kDefaultPublicInterfaceOnly;
   if (preference == kWebRTCIPHandlingDisableNonProxiedUdp)
     return kDisableNonProxiedUdp;
-  return kDefault;
+  if (preference == kWebRTCIPHandlingDefault)
+    return kDefault;
+  return kDisableNonProxiedUdp;
 }
 
 bool IsValidPortRange(uint16_t min_port, uint16_t max_port) {
@@ -759,7 +761,7 @@
           break;
       }
 
-      VLOG(3) << "WebRTC routing preferences: "
+      LOG(INFO) << "WebRTC routing preferences: "
               << "policy: " << policy
               << ", multiple_routes: " << port_config.enable_multiple_routes
               << ", nonproxied_udp: " << port_config.enable_nonproxied_udp
